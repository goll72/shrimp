digraph fetch {
	label="fetch\n-----\n";
	labelloc="t";
	fontsize=20;
	fontname="mono";

	node [shape=oval, fontname="mono"];
	fetch [label="mem.addr = PC\nmem.r = 1\nmem.w = 0\nmem.en = 1\nPC.in = PC + 1\nPC.w = 1\nIR = mem.out"];
	decode [label="if opcode = ..."];
	handleIrq [label="counter = 0"];
	s_irq [label="IRQ state"];

	node [shape=diamond, fontname="mono"];
	Irq [label="irq == 1?"];

	node [shape=oval, style=invisible];
	X1;
	X2;
	X3;
	X4;
	X5;

	Irq -> fetch [label="no"];
	Irq -> handleIrq [label="yes"];
	handleIrq -> s_irq;
	fetch -> decode;
	decode -> X1;
	decode -> X2;
	decode -> X3;
	decode -> X4;
	decode -> X5;
}
